{{- define "variables" -}}
{{- .Store.Set "hasTwic" true -}}
{{- .Store.Set "hasObscure" true -}}
{{- end -}}
{{- define "main" -}}
{{ partial "hero.html" . }}
<article class="[ full-width content-grid layout--spacing section--padding ]">
    <div class="[ layout--sidebar--left grid layout--spacing col-gap--2 ]">
      <div class="[ content ]">
        <div class="[ grid row-gap--1 ]">
          <div>
            <h2 class="[ font--5 ]">Overview</h2>
            <p class="[ pb--0 ]">{{ .Params.overview }}</p>
          </div>
          <div>
            <h3 class="[ font--5 ]">Deliverables:</h3>
            {{/* Build a lookup: Service Name -> URL from the Services submenu */}}
            {{ $services := dict }}
            {{ $parent := index (where $.Site.Menus.main "Identifier" "services") 0 }}
            {{ with $parent }}
              {{ range .Children }}
                {{ $services = merge $services (dict .Name .URL) }}
              {{ end }}
            {{ end }}
            <p class="[ pb--0 ]">
              {{- $items := slice -}}
              {{- range .Params.deliverables }}
                {{ $name := . }}
                {{ with index $services $name }}
                  {{ $items = $items | append (printf `<a href="%s" data-prefetch>%s</a>` . $name) }}
                {{ else }}
                  {{ $items = $items | append $name }}
                {{ end }}
              {{ end }}
              {{ delimit $items ", " | safeHTML }}
            </p>

          </div>
          <div>
            <div>
              <h3 class="[ font--5 ]">Industry</h3>
              {{ with .GetTerms "industries" }}
              {{- $items := slice -}}
                {{- range . }}
                  {{- $items = $items | append (printf `<a href="%s" data-prefetch>%s</a>` .RelPermalink .LinkTitle) -}}
                {{- end }}
                <p class="industries">{{ delimit $items ", " | safeHTML }}</p>
              {{ end }}
            </div>
          </div>
          <div>
            <h3 class="[ font--5 ]">Website</h3>
            <a href="{{ .Params.project_link }}" target="_blank" rel="noopener">{{ .Params.project_link }}</a>
          </div>

        </div>
      </div>
      {{ partial "laptop.html" . }}
    </div>
    <div class="[ grid md:col--3 gap--2 ]">
      <div>
        <h3 class="[ flex col-gap--0.5 ]">
          <span class="[ icon icon--tabler ]">
            {{ readFile "static/icons/tabler/user.svg" | safeHTML }}
          </span>
          <span>Client</span>
        </h3>
        <p>{{ .Params.client }}</p>
      </div>
      <div>
        <h3 class="[ flex col-gap--0.5 ]">
          <span class="[ icon icon--tabler ]">
            {{ readFile "static/icons/tabler/alert-triangle.svg" | safeHTML }}
          </span>
          Challenge</h3>
        <p>{{ .Params.challenge }}</p>
      </div>
      <div>
        <h3 class="[ flex col-gap--0.5 ]">
          <span class="[ icon icon--tabler ]">
            {{ readFile "static/icons/tabler/bulb.svg" | safeHTML }}
          </span>
          Solution</h3>
        <p>{{ .Params.solution }}</p>
      </div>
    </div>
</article>
{{ partial "cta.html" . }}
{{ end }}